import pandas as pd
from tqdm import tqdm


def filter_snp_ids(input_excel: str, output_csv: str, snp_list):
    """
    Reads an Excel file into a Pandas DataFrame, filters it by SNP_ID column values present in a text file,
    and saves the filtered DataFrame to a CSV file.

    :param input_excel: Path to the input Excel file.
    :param output_csv: Path to save the output CSV file.
    :param snp_list: List of SNP_IDs.
    """

    new_list = []

    # Loop through SNP list with a progress bar
    for item in tqdm(snp_list, desc="Processing SNPs", unit="snp"):
        new_list.append(item[:-2])

    # Load Excel file into DataFrame
    df = pd.read_excel(input_excel)

    # Ensure SNP_ID column exists
    if 'SNP_ID' not in df.columns:
        raise ValueError("The input Excel file must contain a 'SNP_ID' column.")

    # Filter DataFrame
    filtered_df = df[df['SNP_ID'].isin(new_list)]

    # Save filtered DataFrame to CSV
    filtered_df.to_csv(output_csv, index=False)

    print(f"Filtered data saved to {output_csv}")

my_list = ['BovineHD0300003636_B', 'BovineHD2900005283_A', 'BovineHD1800013333_A', 'BovineHD2900005177_B', 'BovineHD1700012328_B', 'BovineHD2400004666_A', 'BovineHD1000025164_A', 'BovineHD3000036298_A', 'BovineHD0100025783_A', 'BovineHD0100025792_A', 'BovineHD2400004665_A', 'BovineHD0800012961_B', 'BovineHD2300002949_A', 'BovineHD0200029796_B', 'BovineHD2900005204_A', 'BovineHD1000025162_B', 'BovineHD1800005126_B', 'BovineHD0200039248_A', 'BovineHD2600013380_A', 'BovineHD1700004375_A', 'BovineHD2300002952_B', 'BovineHD0300030923_A', 'BovineHD2900005200_A', 'BovineHD3000036346_B', 'BovineHD2900005180_A', 'BovineHD2300003259_A', 'BovineHD2300002948_B', 'ARS-BFGL-NGS-20741_A', 'BovineHD0200039286_B', 'BovineHD1700004384_A', 'BovineHD0300004194_B', 'BovineHD0600030620_B', 'BovineHD1500004073_B', 'BovineHD0600030621_B', 'BovineHD0300003639_B', 'BovineHD1700003987_A', 'BovineHD1900006082_A', 'BovineHD0300030922_A', 'BovineHD2900005185_B', 'BovineHD0200034720_A', 'BovineHD2000000967_B', 'BovineHD0600030635_B', 'BovineHD1800005127_B', 'BovineHD1400018024_A', 'BovineHD2100014097_B', 'BovineHD0600030469_A', 'BovineHD0200028565_A', 'BovineHD1700004370_B', 'BovineHD0100023515_B', 'BovineHD2800010606_B', 'BovineHD1700004388_A', 'BovineHD2200015532_B', 'BovineHD2900005282_B', 'BovineHD2100014104_A', 'BovineHD0200008912_A', 'BovineHD4100005582_B', 'ARS-BFGL-NGS-79814_A', 'BovineHD0100025797_A', 'BovineHD2100014096_B', 'BovineHD2900005203_A', 'BovineHD1100014370_A', 'BovineHD1700004364_A', 'BTA-64972-no-rs_B', 'BovineHD1700004376_A', 'BovineHD0200039292_A', 'BovineHD1500017346_A', 'BovineHD0200029782_B', 'BovineHD1700004366_A', 'BovineHD4100017496_A', 'BovineHD1000024011_A', 'BovineHD0200008917_A', 'BovineHD2100014084_B', 'BovineHD0900030015_B', 'BovineHD2100014109_A', 'BovineHD2100014102_A', 'BovineHD2300010209_A', 'BovineHD2100014087_A', 'BovineHD2100014108_A', 'BovineHD0600003104_A', 'BovineHD1700004386_B', 'BovineHD2400016783_A', 'BovineHD1300023816_A', 'BovineHD0600032248_B', 'BovineHD1800005464_B', 'BovineHD2900005264_A', 'BovineHD0200008907_B', 'BTB-01297598_A', 'BovineHD2900005208_A', 'BovineHD0600030628_A', 'BovineHD0100009437_A', 'BovineHD1700008945_B', 'BovineHD1400023856_B', 'BovineHD1700004387_B', 'BovineHD0600030489_B', 'BovineHD2600013710_B', 'BovineHD0400035014_B', 'BovineHD0300030914_A', 'BovineHD0300030919_A', 'BovineHD0400020943_B', 'BovineHD1800007204_A', 'BovineHD0200039293_B', 'BovineHD1300023817_A', 'BovineHD0100006802_B', 'BovineHD2300002950_A', 'BovineHD0700029878_A', 'BovineHD2100014094_A', 'BovineHD1800013335_B', 'BovineHD0200029862_B', 'BovineHD2100014103_A', 'BovineHD0900000739_B', 'BovineHD3000036296_B', 'BovineHD1300011415_A', 'BovineHD0200029863_B', 'BovineHD0100009444_A', 'BovineHD0200008906_B', 'BovineHD0200039524_A', 'BovineHD1700004374_A', 'BovineHD0600032252_B', 'BovineHD2100014089_B', 'BovineHD1700004362_A', 'BovineHD1600010353_B', 'BovineHD1900008928_B', 'BovineHD0200029864_B', 'BovineHD2900005259_B', 'BovineHD0600030470_A', 'BovineHD1200025062_A', 'BovineHD0700020665_A', 'BovineHD1700004383_B', 'BovineHD2100014106_B', 'BovineHD1700004382_A', 'ARS-BFGL-NGS-58369_A', 'BovineHD1700004385_B', 'BovineHD0200008916_A', 'BovineHD2100014100_B', 'BovineHD2600013731_B', 'BovineHD2700011527_B', 'BovineHD0300030915_A', 'BovineHD2100014082_B', 'BovineHD1700004373_B', 'BovineHD0200039279_A', 'BovineHD2100014090_A', 'BovineHD0200029813_B', 'BovineHD0300030912_B', 'ARS-BFGL-NGS-113666_A', 'BovineHD1000005911_B', 'BovineHD1800005469_B', 'BovineHD1800007205_B', 'BovineHD1400023609_A', 'BovineHD0200029859_B', 'BovineHD0600030619_B', 'BovineHD4100015598_B', 'BovineHD2100014095_A', 'BovineHD0100010659_B', 'BovineHD1600015304_A', 'BovineHD0500016299_A', 'BovineHD2200008944_A', 'BovineHD0600032153_A', 'BovineHD4100018046_B', 'BovineHD0500026704_A', 'BovineHD2100014107_B', 'BovineHD0900000736_B', 'BovineHD0600030625_B', 'BovineHD0800001056_B', 'BovineHD1600004438_A', 'BovineHD0200029865_A', 'BovineHD0100025784_B', 'BovineHD0600030487_A', 'ARS-BFGL-NGS-37274_A', 'BovineHD4100005618_A', 'BovineHD0600032154_B', 'BovineHD1700004381_B', 'BovineHD1900013004_B', 'BovineHD0100041844_A', 'BovineHD0900008261_B', 'BovineHD0400013884_A', 'BovineHD0300005267_B', 'BovineHD2300005617_A', 'BovineHD3000020514_B', 'BTA-106183-no-rs_A', 'BovineHD2700003106_A', 'BovineHD2000015273_B', 'BovineHD2000019639_B', 'BovineHD0200029866_B', 'BovineHD1800007203_B', 'BovineHD2400004701_A', 'BovineHD2200005439_B', 'BovineHD1700004380_A', 'BovineHD0900006486_B', 'BovineHD0500030546_A', 'BovineHD2100014088_B', 'BovineHD0900006485_B', 'BovineHD2200005422_B', 'BovineHD4100015955_B', 'BovineHD0700032584_B', 'BovineHD0900000734_B', 'BovineHD3000044649_B', 'BovineHD0600002841_B', 'BovineHD1700004365_B', 'BovineHD0800000831_A', 'BovineHD1700003979_A', 'BovineHD0200029820_B', 'BovineHD0900025861_B', 'BovineHD1700004301_B', 'BovineHD0400035018_A', 'BovineHD0900022178_A', 'BovineHD2900004130_B', 'BovineHD1600005995_B', 'BovineHD0200011716_A', 'BovineHD1200002818_B', 'BovineHD2800011803_A', 'BovineHD2000016425_A', 'BovineHD2300000869_B', 'BovineHD0300030918_A', 'BovineHD1000024010_B', 'BovineHD0900000391_A', 'BovineHD0600032145_A', 'BovineHD3000039020_A', 'BovineHD0200005443_A', 'BovineHD2200001947_A', 'BovineHD1800005463_B', 'BovineHD0300005269_B', 'BovineHD0500004344_A', 'BTB-00345453_B', 'BovineHD0500030555_B', 'BovineHD0600032143_A', 'BovineHD2200015414_B', 'BovineHD0800013203_A', 'BovineHD2200004298_A', 'BovineHD0300030920_B', 'BovineHD0800009654_B', 'BovineHD1400007347_A', 'BovineHD0500018366_A', 'BovineHD2700011238_B', 'BovineHD3000046134_B', 'BovineHD1700000744_A', 'BovineHD1000016964_B', 'BovineHD1900008930_B', 'BovineHD2200008943_B', 'BovineHD0900000743_A', 'BovineHD2900005265_A', 'BovineHD0300001521_B', 'BovineHD0800001055_B', 'BovineHD1700004005_A', 'BovineHD1100016464_A', 'BovineHD0900008526_A', 'BovineHD0600032147_B', 'BovineHD2600012885_B', 'BovineHD3000002642_B', 'BovineHD1900008925_A', 'BovineHD0200031928_B', 'BovineHD2200013376_B', 'BovineHD0100024992_B', 'BovineHD2900006279_A', 'BovineHD1000005910_A', 'BovineHD2900004131_B', 'BovineHD1600015305_B', 'BovineHD2100009882_A', 'BovineHD0100006803_B', 'BovineHD4100004045_A', 'BovineHD0500018363_A', 'BovineHD2100014086_B', 'BovineHD1700004371_B', 'BovineHD0200039530_B', 'BovineHD0900029180_A', 'BovineHD1900017184_A', 'BovineHD0900029182_A', 'BovineHD0500030547_A', 'BovineHD1700002167_B', 'BovineHD2200004596_B', 'BovineHD2200016798_A', 'BovineHD0900000741_A', 'BovineHD1700004377_A', 'BovineHD3000020522_B', 'BovineHD0600030624_A', 'BovineHD1700001956_A', 'BovineHD0400000454_A', 'BovineHD3000020515_B', 'BovineHD1700004368_B', 'BovineHD3000020532_A', 'BovineHD1800007219_A', 'BovineHD4100015597_B', 'BovineHD1000027085_B', 'BovineHD1400021835_A', 'BovineHD2700011234_A', 'BovineHD2200015538_A', 'BovineHD0100012622_A', 'BovineHD2100014113_A', 'BovineHD0400009757_B', 'BovineHD2200005423_A', 'BovineHD0900008520_A', 'BTB-01650090_B', 'BovineHD0700000006_B', 'BovineHD1200002816_A', 'ARS-BFGL-NGS-64718_B', 'BovineHD2000019640_A', 'BTA-106195-no-rs_B', 'BovineHD1800007229_B', 'BTB-01315661_B', 'BovineHD0800013348_A', 'Hapmap49355-BTA-87438_B', 'BovineHD0300003635_B', 'BovineHD1800006682_B', 'BovineHD1700021682_A', 'BovineHD2100014092_A', 'BovineHD3000020543_A', 'BovineHD0100010664_B', 'BovineHD1000005775_A', 'BovineHD1000002842_B', 'BovineHD4100015956_A', 'BovineHD0600032151_B', 'BovineHD1000005908_A', 'BovineHD1700003986_B', 'BovineHD0700026127_A', 'BovineHD3000023055_A', 'BovineHD0200034722_B', 'BovineHD0100009428_A', 'BovineHD0500018491_B', 'BovineHD0100010661_A', 'BovineHD0900025731_A', 'BovineHD2100005795_B', 'BovineHD2800011122_B', 'BovineHD0500018358_B', 'BovineHD2100014110_B', 'BovineHD0600030626_A', 'BovineHD2500001506_B', 'BovineHD1800007215_A', 'BovineHD1400017719_B', 'BovineHD2200002662_B', 'BovineHD1000005776_B', 'BovineHD1700004378_A', 'BovineHD2100014105_A', 'BovineHD0500004599_B', 'BovineHD2100009870_B', 'BovineHD0300030921_B', 'BovineHD0700020663_B', 'BovineHD1000000782_A', 'BovineHD0300027755_B', 'ARS-BFGL-BAC-35928_B', 'BovineHD1700022179_A', 'BovineHD1800006042_B', 'BovineHD0900011914_A', 'BovineHD1700000058_A', 'BovineHD0200038269_B', 'BovineHD0100001593_A', 'BovineHD2300004494_B', 'BovineHD1000005909_B', 'BovineHD0300030917_A', 'BovineHD1800012350_B', 'ARS-BFGL-NGS-35781_A', 'BovineHD2300010114_A', 'BovineHD1200023040_A', 'BovineHD0900008522_B', 'BovineHD3000020539_B', 'BovineHD2000001852_B', 'BovineHD1700004302_B', 'BovineHD2900006259_B', 'BovineHD0300002195_A', 'BovineHD0200031929_B', 'BovineHD1800007224_A', 'BovineHD1800009991_A', 'BovineHD1800007280_B', 'BovineHD0700016748_A', 'BovineHD3000044815_B', 'BovineHD3000000087_B', 'BovineHD3000036352_A', 'BovineHD2100009878_A', 'BovineHD0800013344_A', 'BovineHD0900005275_B', 'BovineHD0700005322_B', 'BovineHD2900004383_B', 'BovineHD0900003131_A', 'BovineHD1000018215_B', 'BovineHD0500030543_A', 'BovineHD2200015410_B', 'BTB-01130451_B', 'BovineHD0100042221_A', 'BovineHD2700011235_A', 'BovineHD3000039018_B', 'BovineHD2200005453_A', 'BovineHD1700003976_A', 'BovineHD3000020524_A', 'BovineHD2600013047_A', 'BovineHD2000019719_A', 'BovineHD0900010485_A', 'BovineHD0700004023_A', 'ARS-BFGL-NGS-100464_B', 'BovineHD2200008945_B', 'BovineHD0100012589_A', 'BovineHD0900027834_A', 'BovineHD0900003133_B', 'BovineHD2300002951_B', 'BovineHD2400011515_B', 'BovineHD3000022621_A', 'BovineHD1700002678_B', 'BovineHD0100010660_B', 'BovineHD0700000060_B', 'BovineHD0600019376_A', 'BovineHD1100006255_A', 'BovineHD0700026366_B', 'BovineHD0300021132_B', 'BovineHD0200008915_A', 'BovineHD0200039298_B', 'BovineHD2100014093_B', 'BovineHD2400011513_B', 'BovineHD1500016010_A', 'BovineHD2800001905_A', 'BovineHD1500020008_B', 'BovineHD2200005421_B', 'BovineHD1500017354_A', 'BovineHD1800007222_A', 'BovineHD0100002218_A', 'BovineHD2600012235_A', 'BovineHD1000025158_A', 'BovineHD1000005075_A', 'BovineHD2200001945_A', 'BovineHD2100020383_B', 'BovineHD0900022180_A', 'BovineHD0400000455_B', 'BovineHD0800033714_B', 'BovineHD1700004320_B', 'BovineHD1500008041_A', 'BovineHD2200005479_A', 'BovineHD1300021598_B', 'BovineHD2100009880_A', 'BovineHD1600010350_A', 'BovineHD2600013751_A', 'BovineHD1500006884_B', 'BovineHD1700003971_A', 'BovineHD0200039313_B', 'ARS-BFGL-NGS-56254_B', 'BovineHD0800000560_A', 'BovineHD0600030623_B', 'BovineHD0100023518_A', 'BovineHD0700029696_A', 'ARS-BFGL-NGS-113949_A', 'BovineHD0800020882_A', 'BovineHD2600012227_B', 'BovineHD1400021694_A', 'BovineHD1600023276_B', 'BovineHD2100009875_B', 'BovineHD1000018216_B', 'ARS-BFGL-NGS-73693_A', 'BovineHD0500018365_B', 'BovineHD1500023142_A', 'BovineHD2600002335_B', 'BovineHD2100007512_B', 'BovineHD1700004369_A', 'BovineHD3000000144_A', 'BovineHD1600006844_A', 'BovineHD2700011243_A', 'BovineHD1000030139_A', 'BTA-09585-no-rs_A', 'BovineHD0800015224_B', 'BovineHD0400005316_B', 'BovineHD1200019222_B', 'BovineHD0200038267_B', 'BovineHD2400004702_B', 'BovineHD0700000645_B', 'BovineHD0100029119_B', 'BovineHD0400028101_A', 'BovineHD0200039312_A', 'BovineHD1200019224_B', 'BovineHD0700032957_B', 'BovineHD2900015011_A', 'BovineHD1800005465_A', 'BovineHD0500031362_B', 'BovineHD0400000357_B', 'BovineHD1000030142_B', 'BovineHD0100001584_A', 'BovineHD1600010485_B', 'BovineHD1800017692_A', 'BovineHD2900006281_B', 'BovineHD2900006963_B', 'BovineHD2400016351_A', 'BovineHD1800007228_A', 'BovineHD0900000746_A', 'BovineHD1000000779_A', 'BovineHD0700004022_B', 'BovineHD0300027756_A', 'BovineHD1800005458_A', 'BovineHD4100017062_A', 'BovineHD0200001905_B', 'BovineHD1300016170_A', 'BovineHD0400001379_B', 'BovineHD3000017580_B', 'BovineHD1700004409_A', 'BovineHD0200029469_A', 'BovineHD1300023304_A', 'BovineHD0900000738_B', 'BovineHD1500017076_B', 'BovineHD2700000243_A', 'BovineHD0200039523_B', 'BovineHD0500026652_B', 'BovineHD0300007940_B', 'BovineHD4100015288_A', 'BovineHD2400005153_A', 'BovineHD2900000898_A', 'BovineHD2100009871_B', 'BovineHD1900017531_B', 'BovineHD1400018159_B']


filter_snp_ids("map_match.xlsx", "filtered_map_match.csv", my_list)